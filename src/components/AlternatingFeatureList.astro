---
/**
 * AlternatingFeatureList — Parent component that renders 2–4 OverlapImageSection
 * blocks as one coherent module. Themes alternate (teal/white), image placement
 * alternates (left/right), images overlap strongly into the next section.
 * No spacers between items—seamless blending.
 */
import OverlapImageSection from './OverlapImageSection.astro';

interface Feature {
  headline: string;
  introText?: string;
  content?: string;
  bulletPoints?: string[];
  imageUrl: string;
  imageAlt?: string;
  cta?: { text: string; href: string; icon?: 'chevron-down' | 'arrow-right' };
}

interface Props {
  features: Feature[];
  /** First theme: 'teal' or 'white'. Rest alternate. */
  firstTheme?: 'teal' | 'white';
  overlapAmount?: number;
  instanceId?: string | number;
}

const {
  features = [],
  firstTheme = 'teal',
  overlapAmount = 80,
  instanceId = 'default',
} = Astro.props;

const items = features.slice(0, 4);
---

<div class="alternating-feature-list relative">
  {items.map((feature, index) => {
    const isLast = index === items.length - 1;
    const itemOverlap = isLast ? 0 : overlapAmount;
    const imagePlacement = index % 2 === 0 ? 'right' : 'left';
    const theme = index % 2 === 0 ? firstTheme : firstTheme === 'teal' ? 'white' : 'teal';
    const nextTheme = isLast ? null : index % 2 === 0 ? (firstTheme === 'teal' ? 'white' : 'teal') : firstTheme;
    const bottomDivider =
      isLast ? 'none' : theme !== nextTheme ? 'zigzag' : 'straight';

    return (
      <OverlapImageSection
        headline={feature.headline}
        introText={feature.introText}
        content={feature.content}
        bulletPoints={feature.bulletPoints || []}
        imageUrl={feature.imageUrl}
        imageAlt={feature.imageAlt}
        imagePlacement={imagePlacement}
        overlapAmount={itemOverlap}
        theme={theme}
        bottomDivider={bottomDivider}
        cta={feature.cta}
        instanceId={`${instanceId}-${index}`}
        withinGroup
        topOverlap={index > 0 ? overlapAmount : undefined}
      />
    );
  })}
</div>
