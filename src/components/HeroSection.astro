---
import { buildSrcset } from '../utils/image';

interface Props {
  headline: string;
  description: string;
  primaryCta?: { text: string; href: string };
  secondaryCta?: { text: string; href: string };
  backgroundImage?: string;
  alignment?: 'left' | 'center';
  version?: 'default' | 'minimal' | 'split';
  instanceId?: string | number;
}

const {
  headline = '',
  description = '',
  primaryCta,
  secondaryCta,
  backgroundImage,
  alignment = 'left',
  version = 'default',
  instanceId = 'default',
} = Astro.props;

const isMinimal = version === 'minimal';
const isSplit = version === 'split';
const overlayOpacity = isMinimal ? 'bg-[var(--color-bg-page)]/70' : 'bg-[var(--color-bg-page)]/90';
const pyClass = isMinimal ? 'py-12 md:py-16' : 'py-[var(--section-padding-y-lg)]';
const heroSrcset = backgroundImage ? buildSrcset(backgroundImage) : undefined;
---

<header
  class={`modern-shell relative overflow-hidden ${pyClass} px-[var(--container-padding-x)]`}
  role="banner"
>
  {backgroundImage && !isSplit && (
    <div class="absolute inset-0 z-0">
      <img
        src={backgroundImage}
        srcset={heroSrcset}
        sizes="100vw"
        alt=""
        class="h-full w-full object-cover"
        aria-hidden="true"
        loading="eager"
        fetchpriority="high"
      />
      <div class={`absolute inset-0 ${overlayOpacity}`} aria-hidden="true"></div>
    </div>
  )}
  <div class="relative z-10 mx-auto max-w-[var(--container-max-width)]">
    <div
      class:list={[
        isSplit
          ? 'flex flex-col gap-8 md:flex-row md:items-center md:gap-12'
          : 'flex flex-col gap-6',
        !isSplit && alignment === 'center' && 'items-center text-center',
      ]}
    >
      <div class={isSplit ? 'flex-1' : ''}>
        <span class="eyebrow mb-4">Digital oplevelse</span>
        <h1
          class={`heading-fluid font-bold leading-[var(--line-height-tight)] text-[var(--color-text-primary)] ${
            isMinimal
              ? 'text-[var(--font-size-3xl)] md:text-[var(--font-size-4xl)]'
              : 'text-[var(--font-size-4xl)] md:text-[var(--font-size-5xl)]'
          }`}
          style="font-family: var(--font-heading)"
        >
          {headline}
        </h1>
        <p
          class={`max-w-2xl leading-[var(--line-height-normal)] text-[var(--color-text-secondary)] ${
            isMinimal ? 'text-[var(--font-size-base)] mt-2' : 'text-[var(--font-size-lg)]'
          }`}
          style="font-family: var(--font-body)"
        >
          {description}
        </p>
        {(primaryCta || secondaryCta) && (
          <div
            class:list={[
              'flex flex-col gap-3 sm:flex-row sm:gap-4',
              isMinimal && 'mt-4',
              !isMinimal && 'mt-6',
            ]}
          >
            {primaryCta && (
              <a
                href={primaryCta.href}
                class="focus-modern inline-flex min-h-[44px] min-w-[44px] items-center justify-center rounded-[var(--radius-full)] bg-[var(--color-primary)] px-7 py-3 text-[var(--font-size-base)] font-medium text-[var(--color-text-on-primary)] shadow-[var(--shadow-sm)] transition-colors hover:bg-[var(--color-primary-hover)]"
                style="font-family: var(--font-body)"
              >
                {primaryCta.text}
              </a>
            )}
            {secondaryCta && (
              <a
                href={secondaryCta.href}
                class="focus-modern inline-flex min-h-[44px] min-w-[44px] items-center justify-center rounded-[var(--radius-full)] border-2 border-[var(--color-primary)] px-7 py-3 text-[var(--font-size-base)] font-medium text-[var(--color-primary)] transition-colors hover:bg-[var(--color-primary-light)]"
                style="font-family: var(--font-body)"
              >
                {secondaryCta.text}
              </a>
            )}
          </div>
        )}
      </div>
      {isSplit && backgroundImage && (
        <div class="flex-1 max-w-md md:max-w-lg shrink-0">
          <img
            src={backgroundImage}
            srcset={heroSrcset}
            sizes="(max-width: 768px) 100vw, min(512px, 50vw)"
            alt=""
            class="w-full h-auto rounded-[var(--radius-card)] border border-[var(--color-border)] shadow-[var(--shadow-card)] object-cover"
            loading="eager"
            fetchpriority="high"
          />
        </div>
      )}
    </div>
  </div>
</header>
